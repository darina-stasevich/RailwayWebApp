@startuml
start

if (Авторизован?) then (Да)
else (Нет)
  :Отобразить форму входа/регистрации;
  if (Успешно?) then (Да)
  else (Нет)
    :Показать ошибку;
    stop
  endif
endif

repeat
  
  switch (Выбор действия пользователем)
  case (Изменить данные)
    :Отобразить форму редактирования:
    - Email
    - Телефон
    - Пароль
    - Паспортные данные;
    :Сохранить изменения;
    :Показать "Данные обновлены";
  
  case (Заказать билет)
    :Процесс заказа билета;
    repeat
      :Ввод параметров поиска;
      :Поиск маршрутов (прямые/с пересадками);
      :Просмотр расписания движения;
      :Выбор места;
      :Бронирование;
      :Оплата;
    repeat while (Повторить поиск?) is (Да)
  
  case (Отменить билет)
    :Загрузка активных заказов;
    if (Есть активные заказы?) then (Да)
      :Выбор билета для отмены;
      :Возврат части стоимости;
      :Освобождение мест;
      :Обновление статуса;
      :Показать "Билет отменен";
    else (Нет)
      :Показать "Нет активных заказов";
    endif
  endswitch
  
repeat while (Продолжить работу?) is (Да)
-> Нет;

:Выход из системы;
stop
@enduml